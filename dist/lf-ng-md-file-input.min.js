!function(e,i,n){"use strict";var l=function(){return"lfobjxxxxxxxx".replace(/[xy]/g,function(e){var i=16*Math.random()|0,n="x"==e?i:3&i|8;return n.toString(16)})},t=i.module("lfNgMdFileInput",["ngMaterial"]);t.filter("lfTrusted",["$sce",function(e){return function(i){return e.trustAsResourceUrl(i)}}]),t.directive("lfRequired",function(){return{restrict:"A",require:"ngModel",link:function(e,i,n,l){l&&(l.$validators.required=function(e,i){return e?e.length>0:!1})}}}),t.directive("lfMaxcount",function(){return{restrict:"A",require:"ngModel",link:function(e,i,n,l){if(l){var t=-1;n.$observe("lfMaxcount",function(e){var i=parseInt(e,10);t=isNaN(i)?-1:i,l.$validate()}),l.$validators.maxcount=function(e,i){return e?e.length<=t:!1}}}}}),t.directive("lfFilesize",function(){return{restrict:"A",require:"ngModel",link:function(e,i,n,l){if(l){var t=-1;n.$observe("lfFilesize",function(e){var i=/^[1-9][0-9]*(Byte|KB|MB)$/;if(i.test(e)){var n=["Byte","KB","MB"],r=e.match(i)[1],o=e.substring(0,e.indexOf(r));n.every(function(e,i){return r===e?(t=parseInt(o)*Math.pow(1024,i),!1):!0})}else t=-1;l.$validate()}),l.$validators.filesize=function(e,i){if(!e)return!1;var n=!0;return e.every(function(e,i){return e.lfFile.size>t?(n=!1,!1):!0}),n}}}}}),t.directive("lfTotalsize",function(){return{restrict:"A",require:"ngModel",link:function(e,n,l,t){if(t){var r=-1;l.$observe("lfTotalsize",function(e){var i=/^[1-9][0-9]*(Byte|KB|MB)$/;if(i.test(e)){var n=["Byte","KB","MB"],l=e.match(i)[1],o=e.substring(0,e.indexOf(l));n.every(function(e,i){return l===e?(r=parseInt(o)*Math.pow(1024,i),!1):!0})}else r=-1;t.$validate()}),t.$validators.totalsize=function(e,n){if(!e)return!1;var l=0;return i.forEach(e,function(e,i){l+=e.lfFile.size}),r>l}}}}}),t.directive("lfMimetype",function(){return{restrict:"A",require:"ngModel",link:function(e,i,n,l){if(l){var t;n.$observe("lfMimetype",function(e){t=new RegExp(e,"i"),l.$validate()}),l.$validators.mimetype=function(e,i){if(!e)return!1;var n=!0;return e.every(function(e,i){return e.lfFile.type.match(t)?!0:(n=!1,!1)}),n}}}}}),t.directive("lfNgMdFileInput",["$q","$compile","$timeout",function(t,r,o){return{restrict:"E",template:['<div layout="column" class="lf-ng-md-file-input" ng-model="'+l()+'">','<div layout="column" class="lf-ng-md-file-input-preview-container" ng-class="{\'disabled\':isDisabled}" ng-show="isDrag || (isPreview && !isFilesNull)">','<div class="close lf-ng-md-file-input-x" ng-click="removeAllFiles($event)" ng-hide="isFilesNull || !isPreview" >&times;</div>','<div class="lf-ng-md-file-input-drag">','<div layout="row" layout-align="center center" class="lf-ng-md-file-input-drag-text-container" ng-show="(isFilesNull || !isPreview) && isDrag">','<div class="lf-ng-md-file-input-drag-text">{{strCaptionDragAndDrop}}</div>',"</div>",'<div class="lf-ng-md-file-input-thumbnails" ng-show="isPreview">',"</div>",'<div class="clearfix" style="clear:both"></div>',"</div>","</div>",'<div layout="row" class="lf-ng-md-file-input-container" >','<div class="lf-ng-md-file-input-caption" layout="row" layout-align="start center" flex ng-class="{\'disabled\':isDisabled}" >','<md-icon class="lf-icon" ng-class="strCaptionIconCls"></md-icon>','<div flex class="lf-ng-md-file-input-caption-text-default" ng-show="isFilesNull">',"{{strCaptionPlaceholder}}","</div>",'<div flex class="lf-ng-md-file-input-caption-text" ng-hide="isFilesNull">',"{{strCaption}}","</div>",'<md-progress-linear md-mode="determinate" value="{{floatProgress}}" ng-show="intLoading && isProgress"></md-progress-linear>',"</div>",'<md-button ng-disabled="isDisabled" ng-click="removeAllFiles()" ng-hide="isFilesNull || intLoading" class="md-raised lf-ng-md-file-input-button lf-ng-md-file-input-button-remove" >','<md-icon class="lf-icon" ng-class="strRemoveIconCls"></md-icon> ',"{{strCaptionRemove}}","</md-button>",'<md-button ng-disabled="isDisabled" ng-click="openDialog($event, this)" class="md-raised md-primary lf-ng-md-file-input-button lf-ng-md-file-input-button-brower" >','<md-icon class="lf-icon" ng-class="strBrowseIconCls"></md-icon> ',"{{strCaptionBrowse}}",'<input type="file" aria-label="{{strAriaLabel}}" accept="{{accept}}" ng-disabled="isDisabled" class="lf-ng-md-file-input-tag" />',"</md-button>","</div>","</div>"].join(""),replace:!0,require:"ngModel",scope:{lfFiles:"=?",lfApi:"=?",lfOption:"=?",lfCaption:"@?",lfPlaceholder:"@?",lfDragAndDropLabel:"@?",lfBrowseLabel:"@?",lfRemoveLabel:"@?",lfOnFileClick:"=?",accept:"@?",ngDisabled:"=?"},link:function(a,s,f,c){var d=i.element(s[0].querySelector(".lf-ng-md-file-input-tag")),u=i.element(s[0].querySelector(".lf-ng-md-file-input-drag")),p=i.element(s[0].querySelector(".lf-ng-md-file-input-thumbnails")),m=!1,g=0;a.intLoading=0,a.floatProgress=0,a.isPreview=!1,a.isDrag=!1,a.isMutiple=!1,a.isProgress=!1,i.isDefined(f.preview)&&(a.isPreview=!0),i.isDefined(f.drag)&&(a.isDrag=!0),i.isDefined(f.multiple)?(d.attr("multiple","multiple"),a.isMutiple=!0):d.removeAttr("multiple"),i.isDefined(f.progress)&&(a.isProgress=!0),a.isDisabled=!1,i.isDefined(f.ngDisabled)&&a.$watch("ngDisabled",function(e){a.isDisabled=e}),a.strBrowseIconCls="lf-browse",a.strRemoveIconCls="lf-remove",a.strCaptionIconCls="lf-caption",a.strUnknowIconCls="lf-unknow",i.isDefined(f.lfOption)&&i.isObject(a.lfOption)&&(a.lfOption.hasOwnProperty("browseIconCls")&&(a.strBrowseIconCls=a.lfOption.browseIconCls),a.lfOption.hasOwnProperty("removeIconCls")&&(a.strRemoveIconCls=a.lfOption.removeIconCls),a.lfOption.hasOwnProperty("captionIconCls")&&(a.strCaptionIconCls=a.lfOption.captionIconCls),a.lfOption.hasOwnProperty("unknowIconCls")&&(a.strUnknowIconCls=a.lfOption.unknowIconCls)),a.accept=a.accept||"",a.lfFiles=[],a[f.ngModel]=a.lfFiles,a.$watch("lfFiles.length",function(e,i){c.$validate()}),a.lfApi=new function(){var e=this;e.removeAll=function(){a.removeAllFiles()},e.removeByName=function(e){a.removeFileByName(e)}},a.isFilesNull=!0,a.strCaption="",a.strCaptionPlaceholder="Select file",a.strCaptionDragAndDrop="Drag & drop files here...",a.strCaptionBrowse="Browse",a.strCaptionRemove="Remove",a.strAriaLabel="",i.isDefined(f.ariaLabel)&&(a.strAriaLabel=f.ariaLabel),i.isDefined(f.lfPlaceholder)&&a.$watch("lfPlaceholder",function(e){a.strCaptionPlaceholder=e}),i.isDefined(f.lfCaption)&&(m=!0,a.$watch("lfCaption",function(e){a.strCaption=e})),a.lfDragAndDropLabel&&(a.strCaptionDragAndDrop=a.lfDragAndDropLabel),a.lfBrowseLabel&&(a.strCaptionBrowse=a.lfBrowseLabel),a.lfRemoveLabel&&(a.strCaptionRemove=a.lfRemoveLabel),u.bind("dragover",function(e){e.stopPropagation(),e.preventDefault(),!a.isDisabled&&a.isDrag&&u.addClass("lf-ng-md-file-input-drag-hover")}),u.bind("dragleave",function(e){e.stopPropagation(),e.preventDefault(),!a.isDisabled&&a.isDrag&&u.removeClass("lf-ng-md-file-input-drag-hover")}),u.bind("drop",function(e){if(e.stopPropagation(),e.preventDefault(),!a.isDisabled&&a.isDrag){u.removeClass("lf-ng-md-file-input-drag-hover"),i.isObject(e.originalEvent)&&(e=e.originalEvent);var n=e.target.files||e.dataTransfer.files,l=0;if(!(n.length<=0)){var t=a.lfFiles.map(function(e){return e.lfFileName}),r=new RegExp(a.accept,"i");if(a.floatProgress=0,a.isMutiple){g=n.length;for(var l=0;l<n.length;l++){var o=n[l];o.type.match(r)&&(-1!=t.indexOf(o.name)&&a.removeFileByName(o.name),setTimeout(v(o),100*l))}}else{g=1;for(var l=0;l<n.length;l++){var o=n[l];if(o.type.match(r)){a.removeAllFiles(),setTimeout(v(o),100);break}}}}}}),a.openDialog=function(e,i){e&&o(function(){e.preventDefault(),e.stopPropagation();var i=e.target.children[2];i!==n&&i.click()},0)},a.removeAllFiles=function(e){a.isDisabled||(a.lfFiles.length=0,p.empty(),b())},a.removeFileByName=function(e,i){a.isDisabled||(a.lfFiles.every(function(i,n){return i.lfFileName==e?(i.element.remove(),a.lfFiles.splice(n,1),!1):!0}),b())},a.onFileChanged=function(e){var i=e.files||e.target.files,n=a.lfFiles.map(function(e){return e.lfFileName});if(!(i.length<=0)){if(a.floatProgress=0,a.isMutiple){g=i.length;for(var l=0;l<i.length;l++){var t=i[l];-1!=n.indexOf(t.name)&&a.removeFileByName(t.name),setTimeout(v(t),100*l)}}else{g=1;for(var l=0;l<i.length;l++){var t=i[l];a.removeAllFiles(),setTimeout(v(t),100);break}}d.val("")}},d.bind("change",a.onFileChanged),a.onFileClick=function(e){i.isFunction(a.lfOnFileClick)&&a.lfFiles.every(function(i,n){return i.key==e?(a.lfOnFileClick(i,n),!1):!0})};var v=function(n){a.intLoading++,y(n).then(function(t){var o=n,s=n.name,f=n.type,c=h(n),d=e.URL.createObjectURL(n),u={key:l(),lfFile:o,lfFileName:s,lfDataUrl:d};a.lfFiles.push(u);var m=i.element('<div class="lf-ng-md-file-input-frame" ng-click="onFileClick(\''+u.key+"')\"></div>"),g=i.element('<div class="lf-ng-md-file-input-x" ng-click="removeFileByName(\''+n.name+"',$event)\">&times;</div>"),v="";v="image"==c?'<img src="'+d+'" >':"video"==c?["<video controls>",'<source src="'+d+'" type="'+f+'">',"</video>"].join(""):"audio"==c?["<audio controls>",'<source src="'+d+'" type="'+f+'">',"</audio>"].join(""):['<object data="'+d+'" type="'+f+'"><param name="movie" value="'+o.name+'" />','<div class="lf-ng-md-file-input-preview-default">','<md-icon class="lf-ng-md-file-input-preview-icon" ng-class="strUnknowIconCls"></md-icon>',"</div>","</object>"].join("");var w=i.element(v),F=i.element('<div class="lf-ng-md-file-input-frame-footer"><div class="lf-ng-md-file-input-frame-caption">'+o.name+"</div></div>");m.append(g),m.append(w),m.append(F),r(m)(a),p.append(m),u.element=m,b()},function(e){},function(e){})},b=function(){1==a.lfFiles.length?(m||(a.strCaption=""+a.lfFiles[0].lfFileName),a.isFilesNull=!1):a.lfFiles.length>1?(m||(a.strCaption=""+a.lfFiles.length+" files selected"),a.isFilesNull=!1):(m||(a.strCaption=""),a.isFilesNull=!0)},h=function(e){var i=e.type,n=e.name;return w(i,n)?"image":F(i,n)?"video":C(i,n)?"audio":"object"},w=function(e,i){return!(!e.match("image.*")&&!i.match(/\.(gif|png|jpe?g)$/i))},F=function(e,i){return!(!e.match("video.*")&&!i.match(/\.(og?|mp4|webm|3gp)$/i))},C=function(e,i){return!(!e.match("audio.*")&&!i.match(/\.(ogg|mp3|wav)$/i))},y=function(e,i){var n=t.defer(),l=new FileReader;return l.onloadstart=function(){n.notify(0)},l.onload=function(e){},l.onloadend=function(e){n.resolve({index:i,result:l.result}),a.intLoading--,a.floatProgress=(g-a.intLoading)/g*100},l.onerror=function(e){n.reject(l.result),a.intLoading--,a.floatProgress=(g-a.intLoading)/g*100},l.onprogress=function(e){n.notify(e.loaded/e.total)},l.readAsArrayBuffer(e),n.promise}}}}])}(window,window.angular);